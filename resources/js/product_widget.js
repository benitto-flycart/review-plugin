/*
 * ATTENTION: The "eval" devtool has been used (maybe by default in mode: "development").
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/product-widget/index.ts":
/*!*************************************!*\
  !*** ./src/product-widget/index.ts ***!
  \*************************************/
/***/ ((__unused_webpack_module, exports, __webpack_require__) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nvar product_widget_1 = __webpack_require__(/*! ./product-widget */ \"./src/product-widget/product-widget.ts\");\njQuery(document).ready(function ($) {\n    (function PRODUCT_WIDGET_DEFAULT() {\n        var productWidget = new product_widget_1.ProductWidget(document, $);\n        productWidget.init();\n    })();\n});\n\n\n//# sourceURL=webpack://scripts/./src/product-widget/index.ts?");

/***/ }),

/***/ "./src/product-widget/layout.ts":
/*!**************************************!*\
  !*** ./src/product-widget/layout.ts ***!
  \**************************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.masonryLayout = masonryLayout;\nexports.mosaicLayout = mosaicLayout;\nfunction masonryLayout(shadowRoot) {\n    var elem = shadowRoot.querySelector(\".r_pw_g_all_reviews_container\");\n    if (!elem) {\n        console.error(\"Container not found\");\n        return;\n    }\n    var images = elem.querySelectorAll(\"img\");\n    var loadedImagesCount = 0;\n    // Function to check if all images have loaded\n    var checkAllImagesLoaded = function () {\n        loadedImagesCount++;\n        if (loadedImagesCount === images.length) {\n            console.log(\"All images are loaded\");\n            // Initialize Masonry after all images have loaded\n            //@ts-ignore\n            var msnry = new Masonry(elem, {\n                itemSelector: \".r_pw_r_g_container\",\n                percentPosition: true,\n                gutter: 15,\n            });\n            // Set the container opacity to 1 (if you want a fade-in effect)\n            elem.style.opacity = \"1\";\n        }\n    };\n    // If there are images, set initial opacity and wait for them to load\n    if (images.length > 0) {\n        // Set initial opacity to 0 (for fade-in after loading)\n        elem.style.opacity = \"0.2\";\n        // Attach load event listener to each image\n        images.forEach(function (img) {\n            if (img.complete) {\n                // If the image is already cached and loaded, increment the counter\n                checkAllImagesLoaded();\n            }\n            else {\n                // If the image is not yet loaded, listen for the load event\n                img.addEventListener(\"load\", checkAllImagesLoaded);\n                img.addEventListener(\"error\", checkAllImagesLoaded); // Handle errors gracefully\n            }\n        });\n    }\n    else {\n        // If no images, initialize Masonry immediately\n        //@ts-ignore\n        var msnry = new Masonry(elem, {\n            itemSelector: \".r_pw_r_g_container\",\n            percentPosition: true,\n            gutter: 15,\n        });\n        // Set the container opacity to 1 immediately\n        elem.style.opacity = \"1\";\n    }\n}\nfunction mosaicLayout(shadowRoot) {\n    var elem = shadowRoot.querySelector(\".r_pw_r_m_all_reviews_container\");\n    if (!elem) {\n        console.error(\"Container not found\");\n        return;\n    }\n    var images = elem.querySelectorAll(\"img\");\n    var loadedImagesCount = 0;\n    // Function to check if all images have loaded\n    var checkAllImagesLoaded = function () {\n        loadedImagesCount++;\n        if (loadedImagesCount === images.length) {\n            // Initialize Masonry after all images have loaded\n            //@ts-ignore\n            var msnry = new Masonry(elem, {\n                itemSelector: \".r_pw_r_m_container\",\n                percentPosition: true,\n                gutter: 15,\n            });\n            // Set the container opacity to 1 (if you want a fade-in effect)\n            elem.style.opacity = \"1\";\n        }\n    };\n    // If there are images, set initial opacity and wait for them to load\n    if (images.length > 0) {\n        // Set initial opacity to 0 (for fade-in after loading)\n        elem.style.opacity = \"0.2\";\n        // Attach load event listener to each image\n        images.forEach(function (img) {\n            if (img.complete) {\n                // If the image is already cached and loaded, increment the counter\n                checkAllImagesLoaded();\n            }\n            else {\n                // If the image is not yet loaded, listen for the load event\n                img.addEventListener(\"load\", checkAllImagesLoaded);\n                img.addEventListener(\"error\", checkAllImagesLoaded); // Handle errors gracefully\n            }\n        });\n    }\n    else {\n        // If no images, initialize Masonry immediately\n        //@ts-ignore\n        var msnry = new Masonry(elem, {\n            itemSelector: \".r_pw_r_m_container\",\n            percentPosition: true,\n            gutter: 15,\n        });\n        // Set the container opacity to 1 immediately\n        elem.style.opacity = \"1\";\n    }\n}\n\n\n//# sourceURL=webpack://scripts/./src/product-widget/layout.ts?");

/***/ }),

/***/ "./src/product-widget/product-widget.ts":
/*!**********************************************!*\
  !*** ./src/product-widget/product-widget.ts ***!
  \**********************************************/
/***/ (function(__unused_webpack_module, exports, __webpack_require__) {

eval("\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n    return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.ProductWidget = void 0;\nvar ajax_1 = __webpack_require__(/*! ../utils/ajax */ \"./src/utils/ajax.ts\");\nvar layout_1 = __webpack_require__(/*! ./layout */ \"./src/product-widget/layout.ts\");\nvar ProductWidget = /** @class */ (function () {\n    function ProductWidget(parentDom, jquery) {\n        var _this = this;\n        this.details = {\n            current_rating: 0,\n            current_sorting: \"highest\",\n            current_page: 1,\n            apply_rating_filter: false,\n        };\n        this.registerMinimalHeaderEvents = function () {\n            //When user clicks on filter icon toggle the state so that the filter can be shown or hidden\n            var filterRoot = _this.shadowRoot.querySelector(\".r_pw_mh_filter\");\n            filterRoot === null || filterRoot === void 0 ? void 0 : filterRoot.addEventListener(\"click\", function () {\n                var rating_contatiner = _this.shadowRoot.querySelector(\".r_pw_mh_rd_container\");\n                if (_this.jquery(filterRoot).hasClass(\"r_pw_mh_filter_icon_opened\")) {\n                    _this.jquery(filterRoot).removeClass(\"r_pw_mh_filter_icon_opened\");\n                    _this.jquery(filterRoot).addClass(\"r_pw_mh_filter_icon_closed\");\n                }\n                else {\n                    _this.jquery(filterRoot).removeClass(\"r_pw_mh_filter_icon_closed\");\n                    _this.jquery(filterRoot).addClass(\"r_pw_mh_filter_icon_opened\");\n                }\n                _this.jquery(rating_contatiner).toggleClass(\"r_pw_hide\");\n            });\n        };\n        this.shadowRoot = this.initShadowRoot(parentDom);\n        this.jquery = jquery;\n    }\n    ProductWidget.prototype.initShadowRoot = function (parent) {\n        var template = parent.getElementById(\"r_rpw_product_widget_container\");\n        // Step 2: Get the host element where the Shadow DOM will be attached\n        var host = parent.getElementById(\"r_rpw_product_widget_container_wrapper\");\n        var shadowRoot = host.attachShadow({ mode: \"open\" });\n        shadowRoot.appendChild(template.content.cloneNode(true));\n        template.remove();\n        return shadowRoot;\n    };\n    ProductWidget.prototype.init = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var product_id, response, error_1;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        product_id = window.review_product_widget_js_data.product_id;\n                        return [4 /*yield*/, (0, ajax_1.ajaxRequest)(this.jquery, {\n                                url: window.review_product_widget_js_data.ajax_url,\n                                method: \"POST\",\n                                data: {\n                                    action: window.review_product_widget_js_data.action,\n                                    method: \"product_widget_template\",\n                                    _wp_nonce: window.review_product_widget_js_data._wp_nonce,\n                                    _wp_nonce_key: window.review_product_widget_js_data._wp_nonce_key,\n                                    main_content: true,\n                                    header: true,\n                                    wrapper: true,\n                                    product_id: product_id,\n                                },\n                            })];\n                    case 1:\n                        response = _a.sent();\n                        this.renderWidget(response.data);\n                        this.initHeaderAndRegisterEvents();\n                        this.initLayoutAndRegisterEvents();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        error_1 = _a.sent();\n                        console.log(error_1);\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    ProductWidget.prototype.renderWidget = function (data) {\n        var templateData = data.template;\n        var container = this.shadowRoot.querySelector(\"#r_rpw_container_wrapper\");\n        this.jquery(container).html(templateData.wrapper);\n        var wrapper = this.shadowRoot.querySelector(\".wd_preview_content\");\n        this.jquery(wrapper).append(templateData.header);\n        this.jquery(wrapper).append(templateData.main_content);\n    };\n    ProductWidget.prototype.initHeaderAndRegisterEvents = function () {\n        this.registerHeaderEvents();\n    };\n    ProductWidget.prototype.registerHeaderEvents = function () {\n        //Write a Review\n        var _this = this;\n        var _a, _b, _c;\n        (_a = this.shadowRoot\n            .querySelector(\".r_pw_write_a_review_btn\")) === null || _a === void 0 ? void 0 : _a.addEventListener(\"click\", function () {\n            //@ts-ignore\n            window.REVIEW_FORM_WIDGET();\n        });\n        (_b = this.shadowRoot\n            .querySelectorAll(\".r_pw_h_sorting-link\")) === null || _b === void 0 ? void 0 : _b.forEach(function (item) {\n            item.addEventListener(\"click\", function (e) {\n                var sorting = item.getAttribute(\"data-sorting\");\n                _this.details.current_sorting = sorting;\n                _this.details.current_rating = 0;\n                _this.details.current_page = 1;\n                _this.filter();\n            });\n        });\n        (_c = this.shadowRoot\n            .querySelector(\".r_pw_h_sorting_container--trigger\")) === null || _c === void 0 ? void 0 : _c.addEventListener(\"click\", function (e) {\n            var sorting_list_container = _this.shadowRoot.querySelector(\".r_pw_h_sorting_list-container\");\n            _this.jquery(sorting_list_container).toggleClass(\"r_pw_hide\");\n        });\n        var ratingDistributions = this.shadowRoot.querySelectorAll(\".r_pw_h_rd_detail\");\n        ratingDistributions === null || ratingDistributions === void 0 ? void 0 : ratingDistributions.forEach(function (item) {\n            item.addEventListener(\"click\", function (e) {\n                //if both are same user wants to get all the datas\n                if (!_this.details.current_rating ||\n                    _this.details.current_rating == item.getAttribute(\"data-rating\")) {\n                    _this.details.apply_rating_filter = !_this.details.apply_rating_filter;\n                }\n                _this.details.current_rating = item.getAttribute(\"data-rating\");\n                _this.details.current_page = 1;\n                _this.jquery(ratingDistributions).removeClass(\"r_pw_h_rd_detail--active\");\n                if (_this.details.apply_rating_filter) {\n                    _this.jquery(item).addClass(\"r_pw_h_rd_detail--active\");\n                }\n                _this.filter();\n            });\n        });\n        this.registerMinimalHeaderEvents();\n    };\n    ProductWidget.prototype.filter = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var product_id, response, mainContentWrapper, error_2;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        _a.trys.push([0, 2, , 3]);\n                        product_id = window.review_product_widget_js_data.product_id;\n                        return [4 /*yield*/, (0, ajax_1.ajaxRequest)(this.jquery, {\n                                url: window.review_product_widget_js_data.ajax_url,\n                                method: \"POST\",\n                                data: {\n                                    action: window.review_product_widget_js_data.action,\n                                    method: \"product_widget_template\",\n                                    _wp_nonce: window.review_product_widget_js_data._wp_nonce,\n                                    _wp_nonce_key: window.review_product_widget_js_data._wp_nonce_key,\n                                    current_page: this.details.current_page,\n                                    rating: this.details.current_rating,\n                                    sorting: this.details.current_sorting,\n                                    apply_rating_filter: this.details.apply_rating_filter,\n                                    main_content: true,\n                                    product_id: product_id,\n                                },\n                            })];\n                    case 1:\n                        response = _a.sent();\n                        mainContentWrapper = this.shadowRoot.querySelector(\".r_pw_main_container\");\n                        this.jquery(mainContentWrapper).html(response.data.template.main_content);\n                        this.initLayoutAndRegisterEvents();\n                        return [3 /*break*/, 3];\n                    case 2:\n                        error_2 = _a.sent();\n                        console.error(\"Error occurred while filtering\");\n                        return [3 /*break*/, 3];\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    ProductWidget.prototype.initLayoutAndRegisterEvents = function () {\n        if (window.review_product_widget_js_data.widget_content_type === \"grid\") {\n            (0, layout_1.masonryLayout)(this.shadowRoot);\n        }\n        else if (window.review_product_widget_js_data.widget_content_type === \"mosaic\") {\n            (0, layout_1.mosaicLayout)(this.shadowRoot);\n        }\n        this.registerPaginationEvents();\n    };\n    ProductWidget.prototype.registerPaginationEvents = function () {\n        var _this = this;\n        var _a;\n        (_a = this.shadowRoot\n            .querySelectorAll(\".r_w_pagination-link\")) === null || _a === void 0 ? void 0 : _a.forEach(function (item) {\n            item.addEventListener(\"click\", function (e) {\n                _this.details.current_page = item.getAttribute(\"data-pagination-page\");\n                _this.filter();\n            });\n        });\n    };\n    return ProductWidget;\n}());\nexports.ProductWidget = ProductWidget;\n\n\n//# sourceURL=webpack://scripts/./src/product-widget/product-widget.ts?");

/***/ }),

/***/ "./src/utils/ajax.ts":
/*!***************************!*\
  !*** ./src/utils/ajax.ts ***!
  \***************************/
/***/ ((__unused_webpack_module, exports) => {

eval("\nObject.defineProperty(exports, \"__esModule\", ({ value: true }));\nexports.ajaxRequest = ajaxRequest;\nfunction ajaxRequest(jquery, config) {\n    return new Promise(function (resolve, reject) {\n        // @ts-ignore\n        jquery.ajax({\n            url: config.url,\n            method: config.method,\n            data: config.data,\n            contentType: config.contentType || 'application/x-www-form-urlencoded',\n        }).then(function (response) {\n            resolve(response);\n        }).catch(function (error) {\n            reject(error);\n        });\n    });\n}\n\n\n//# sourceURL=webpack://scripts/./src/utils/ajax.ts?");

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./src/product-widget/index.ts");
/******/ 	
/******/ })()
;